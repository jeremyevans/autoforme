<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>AutoForme::Action</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
AutoForme::Action
</h1>
<ol class='paths'>
<li>
<a href="../../files/lib/autoforme/action_rb.html">lib/autoforme/action.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong>Object</strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>Represents an action on a model in response to a web request.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-association_class_link">association_class_link</a></li>
<li><a href="#method-i-association_link">association_link</a></li>
<li><a href="#method-i-association_link_list">association_link_list</a></li>
<li><a href="#method-i-association_links">association_links</a></li>
<li><a href="#method-i-base_url_for">base_url_for</a></li>
<li><a href="#method-i-column_label_for">column_label_for</a></li>
<li><a href="#method-i-column_options_for">column_options_for</a></li>
<li><a href="#method-i-csv">csv</a></li>
<li><a href="#method-i-edit_page">edit_page</a></li>
<li><a href="#method-i-form_attributes">form_attributes</a></li>
<li><a href="#method-i-form_opts">form_opts</a></li>
<li><a href="#method-i-h">h</a></li>
<li><a href="#method-i-handle">handle</a></li>
<li><a href="#method-i-handle_association_links">handle_association_links</a></li>
<li><a href="#method-i-handle_autocomplete">handle_autocomplete</a></li>
<li><a href="#method-i-handle_browse">handle_browse</a></li>
<li><a href="#method-i-handle_create">handle_create</a></li>
<li><a href="#method-i-handle_delete">handle_delete</a></li>
<li><a href="#method-i-handle_destroy">handle_destroy</a></li>
<li><a href="#method-i-handle_edit">handle_edit</a></li>
<li><a href="#method-i-handle_mtm_edit">handle_mtm_edit</a></li>
<li><a href="#method-i-handle_mtm_update">handle_mtm_update</a></li>
<li><a href="#method-i-handle_new">handle_new</a></li>
<li><a href="#method-i-handle_search">handle_search</a></li>
<li><a href="#method-i-handle_show">handle_show</a></li>
<li><a href="#method-i-handle_update">handle_update</a></li>
<li><a href="#method-i-humanize">humanize</a></li>
<li><a href="#method-i-inline_mtm_edit_forms">inline_mtm_edit_forms</a></li>
<li><a href="#method-i-list_page">list_page</a></li>
<li><a href="#attribute-i-model">model</a></li>
<li><a href="#method-i-model_params">model_params</a></li>
<li><a href="#method-i-mtm_edit_remove">mtm_edit_remove</a></li>
<li><a href="#method-i-new_page">new_page</a></li>
<li><a href="#attribute-i-normalized_type">normalized_type</a></li>
<li><a href="#attribute-i-output_filename">output_filename</a></li>
<li><a href="#attribute-i-output_type">output_type</a></li>
<li><a href="#method-i-page">page</a></li>
<li><a href="#attribute-i-params_association">params_association</a></li>
<li><a href="#method-i-redirect">redirect</a></li>
<li><a href="#attribute-i-request">request</a></li>
<li><a href="#method-i-show_page">show_page</a></li>
<li><a href="#method-i-subtype">subtype</a></li>
<li><a href="#method-i-supported-3F">supported?</a></li>
<li><a href="#method-i-tab_name">tab_name</a></li>
<li><a href="#method-i-table_page">table_page</a></li>
<li><a href="#method-i-table_pager">table_pager</a></li>
<li><a href="#method-i-tabs">tabs</a></li>
<li><a href="#attribute-i-title">title</a></li>
<li><a href="#attribute-i-type">type</a></li>
<li><a href="#method-i-url_for">url_for</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='constants-list'>
<h2>Constants</h2>
<div class='name-list'>
<table summary='Constants'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>ALL_SUPPORTED_ACTIONS</td>
<td>=</td>
<td class='context-item-value'>%w'new create show edit update delete destroy browse search mtm_edit mtm_update association_links autocomplete'.freeze</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Array of strings for all action types currently supported</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>NON_IDEMPOTENT_TYPES</td>
<td>=</td>
<td class='context-item-value'>NORMALIZED_ACTION_MAP = {:create=>:new, :update=>:edit, :destroy=>:delete, :mtm_update=>:mtm_edit}</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Map of regular type symbols to normalized type symbols</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>TITLE_MAP</td>
<td>=</td>
<td class='context-item-value'>{:new=>'New', :show=>'Show', :edit=>'Edit', :delete=>'Delete', :browse=>'Browse', :search=>'Search', :mtm_edit=>'Many To Many Edit'}</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Map of type symbols to HTML titles</p>
</td>
</tr>
</table>
</div>
</div>
<div id='attribute-list'>
<h2 class='section-bar'>Attributes</h2>
<div class='name-list'>
<table>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-model'>model</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The <a href="Model.html">AutoForme::Model</a> instance related to the
current action</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-normalized_type'>normalized_type</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The normalized type symbol related to the current action, so that paired
actions such as new and create both use :new.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-output_filename'>output_filename</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The filename to use for file output</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-output_type'>output_type</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The type of output, currently nil for normal output, and &#39;csv&#39; for
csv output</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-params_association'>params_association</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>An association symbol for the current related association.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-request'>request</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The <a href="Request.html">AutoForme::Request</a> instance related to the
current action</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-title'>title</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>An string suitable for use as the HTML title on the displayed page</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-type'>type</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The type symbols related to the current action (e.g. :new, :create).</p>
</td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span>
<span class='arguments'>(model, request)</span>

</div>
<div class='description'>

<p>Creates a new action for the model and request.  This action is not usable
unless supported? is called first and it returns true.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 43</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">model</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-ivar">@model</span> = <span class="ruby-identifier">model</span>&#x000A;  <span class="ruby-ivar">@request</span> = <span class="ruby-identifier">request</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-association_class_link'>
<a name='method-i-association_class_link'></a>
<div class='synopsis'>
<span class='name'>association_class_link</span>
<span class='arguments'>(mc, assoc)</span>

</div>
<div class='description'>

<p>If the framework contains the associated model class and that supports
browsing, return a link to the associated browse page, otherwise, just
return the name.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-association_class_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-association_class_link-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 614</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">association_class_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc</span>)&#x000A;  <span class="ruby-identifier">assoc_name</span> = <span class="ruby-identifier">humanize</span>(<span class="ruby-identifier">assoc</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">mc</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-value">:browse</span>, <span class="ruby-identifier">request</span>)&#x000A;    <span class="ruby-node">&quot;&lt;a href=\&quot;#{base_url_for(&quot;#{mc.link}/browse&quot;)}\&quot;&gt;#{assoc_name}&lt;/a&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">assoc_name</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-association_link'>
<a name='method-i-association_link'></a>
<div class='synopsis'>
<span class='name'>association_link</span>
<span class='arguments'>(mc, assoc_obj)</span>

</div>
<div class='description'>

<p>For the given associated object, if the framework contains the associated
model class, and that supports the type of action we are doing, return a
link to the associated action page.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-association_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-association_link-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 626</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">association_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mc</span>&#x000A;    <span class="ruby-identifier">t</span> = <span class="ruby-identifier">mc</span>.<span class="ruby-identifier">object_display_name</span>(<span class="ruby-value">:association</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">mc</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-identifier">t</span> = <span class="ruby-node">&quot;&lt;a href=\&quot;#{base_url_for(&quot;#{mc.link}/#{type}/#{mc.primary_key_value(assoc_obj)}&quot;)}\&quot;&gt;#{t}&lt;/a&gt;&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">t</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">default_object_display_name</span>(<span class="ruby-identifier">assoc_obj</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-association_link_list'>
<a name='method-i-association_link_list'></a>
<div class='synopsis'>
<span class='name'>association_link_list</span>
<span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>HTML fragment for the list of association links, allowing quick access to
associated models and objects.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-association_link_list-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-association_link_list-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 560</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">association_link_list</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">assocs</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">association_links_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>) &#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">assocs</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">read_only</span> = <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:show</span>&#x000A;  <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;h3 class=&quot;associated_records_header&quot;&gt;Associated Records&lt;/h3&gt;&#39;</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;ul class=&#39;association_links&#39;&gt;\n&quot;</span>&#x000A;  <span class="ruby-identifier">assocs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">mc</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_model_class</span>(<span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;li&gt;&quot;</span>&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_class_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;\n &quot;</span>&#x000A;&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">association_type</span>(<span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:one</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">assoc_obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">assoc</span>)&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; - &quot;</span>&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">assoc_objs</span> = []&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:edit</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">read_only</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_mtm_edit?</span>(<span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">request</span>)&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;(&lt;a href=\&quot;#{url_for(&quot;mtm_edit/#{model.primary_key_value(obj)}?association=#{assoc}&quot;)}\&quot;&gt;associate&lt;/a&gt;)&quot;</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">assoc_objs</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:new</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">read_only</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">mc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">mc</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-value">:new</span>, <span class="ruby-identifier">request</span>)&#x000A;        <span class="ruby-identifier">params</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_new_column_values</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">assoc</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">col</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-node">&quot;#{mc.link}%5b#{col}%5d=#{value}&quot;</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;(&lt;a href=\&quot;#{base_url_for(&quot;#{mc.link}/new?#{params.join(&#39;&amp;amp;&#39;)}&quot;)}\&quot;&gt;create&lt;/a&gt;)&quot;</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">assoc_objs</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">assoc_objs</span> = []&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">assoc_objs</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;ul&gt;\n&quot;</span>&#x000A;      <span class="ruby-identifier">assoc_objs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc_obj1</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;li&gt;&quot;</span>&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc_obj1</span>)&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/li&gt;&quot;</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/ul&gt;&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/li&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/ul&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-association_links'>
<a name='method-i-association_links'></a>
<div class='synopsis'>
<span class='name'>association_links</span>
<span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>HTML fragment containing the association links for the given object, or a
link to lazily load them if configured.  Also contains the inline mtm_edit
forms when editing.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-association_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-association_links-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 549</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">association_links</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">lazy_load_association_links?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">normalized_type</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:association_links</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;associations&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;show&#39;</span>&#x000A;    <span class="ruby-node">&quot;&lt;div id=&#39;lazy_load_association_links&#39; data-object=&#39;#{model.primary_key_value(obj)}&#39; data-type=&#39;#{type}&#39;&gt;&lt;a href=\&quot;#{url_for(&quot;#{type}/#{model.primary_key_value(obj)}?associations=show&quot;)}\&quot;&gt;Show Associations&lt;/a&gt;&lt;/div&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:show</span>&#x000A;    <span class="ruby-identifier">association_link_list</span>(<span class="ruby-identifier">obj</span>).<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-node">&quot;#{inline_mtm_edit_forms(obj)}#{association_link_list(obj)}&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-base_url_for'>
<a name='method-i-base_url_for'></a>
<div class='synopsis'>
<span class='name'>base_url_for</span>
<span class='arguments'>(page)</span>

</div>
<div class='description'>

<p>A path for the given page tied to the framework, but not the current model.
Used for linking to other models in the same framework.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-base_url_for-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-base_url_for-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 110</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">base_url_for</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-node">&quot;#{request.path}#{model.framework.prefix}/#{page}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-column_label_for'>
<a name='method-i-column_label_for'></a>
<div class='synopsis'>
<span class='name'>column_label_for</span>
<span class='arguments'>(type, request, model, column)</span>

</div>
<div class='description'>

<p>The label to use for the given column.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-column_label_for-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-column_label_for-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 173</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_label_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">model</span>, <span class="ruby-identifier">column</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">label</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">column</span>)[<span class="ruby-value">:label</span>]&#x000A;    <span class="ruby-identifier">label</span> = <span class="ruby-identifier">humanize</span>(<span class="ruby-identifier">column</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">label</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-column_options_for'>
<a name='method-i-column_options_for'></a>
<div class='synopsis'>
<span class='name'>column_options_for</span>
<span class='arguments'>(type, request, obj, column)</span>

</div>
<div class='description'>

<p>The options to use for the given column, which will be passed to
Forme::Form#input.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-column_options_for-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-column_options_for-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 160</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">column</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:class</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;autoforme_autocomplete&#39;</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:show</span>&#x000A;      <span class="ruby-identifier">opts</span>[<span class="ruby-value">:value</span>] = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_value</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">key</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">model</span>.<span class="ruby-identifier">association_key</span>(<span class="ruby-identifier">column</span>))&#x000A;      <span class="ruby-identifier">opts</span>[<span class="ruby-value">:value</span>] = <span class="ruby-node">&quot;#{key} - #{model.column_value(type, request, obj, column)}&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">opts</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-csv'>
<a name='method-i-csv'></a>
<div class='synopsis'>
<span class='name'>csv</span>
<span class='arguments'>(meth)</span>

</div>
<div class='description'>

<p>Return a string in CSV format with the results</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-csv-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-csv-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 181</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">csv</span>(<span class="ruby-identifier">meth</span>)&#x000A;  <span class="ruby-ivar">@output_type</span> = <span class="ruby-string">&#39;csv&#39;</span>&#x000A;  <span class="ruby-ivar">@output_filename</span> = <span class="ruby-node">&quot;#{model.link.downcase}_#{normalized_type}.csv&quot;</span>&#x000A;  <span class="ruby-identifier">columns</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">columns_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span> <span class="ruby-identifier">column_label_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">model</span>, <span class="ruby-identifier">column</span>)}&#x000A;  <span class="ruby-constant">EnumCSV</span>.<span class="ruby-identifier">csv</span>(<span class="ruby-identifier">model</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-value">:all_results</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>), <span class="ruby-value">:headers</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">headers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_value</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-edit_page'>
<a name='method-i-edit_page'></a>
<div class='synopsis'>
<span class='name'>edit_page</span>
<span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>The page to use when editing the object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-edit_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-edit_page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 342</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">edit_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;    <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;update/#{model.primary_key_value(obj)}&quot;</span>))&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">model</span>.<span class="ruby-identifier">columns_for</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">column_options_for</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">html</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">edit_html_for</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>, <span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>)&#x000A;          <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">col_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:html</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">html</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">col_opts</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Update&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-value">:delete</span>, <span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;delete/#{model.primary_key_value(obj)}&quot;</span>)), <span class="ruby-identifier">form_opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Delete&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-danger&#39;</span>)&#x000A;      <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_links</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-form_attributes'>
<a name='method-i-form_attributes'></a>
<div class='synopsis'>
<span class='name'>form_attributes</span>
<span class='arguments'>(attrs)</span>

</div>
<div class='description'>

<p>Merge the model&#39;s form attributes into the given form attributes,
yielding the attributes to use for the form.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-form_attributes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-form_attributes-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 238</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">form_attributes</span>(<span class="ruby-identifier">attrs</span>)&#x000A;  <span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">model</span>.<span class="ruby-identifier">form_attributes_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-form_opts'>
<a name='method-i-form_opts'></a>
<div class='synopsis'>
<span class='name'>form_opts</span>
<span class='arguments'>(action=nil)</span>

</div>
<div class='description'>

<p>Options to use for the form.  If the form uses POST, automatically adds the
CSRF token.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-form_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-form_opts-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 227</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">form_opts</span>(<span class="ruby-identifier">action</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">form_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">dup</span>&#x000A;  <span class="ruby-identifier">hidden_tags</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:hidden_tags</span>] = []&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">csrf</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">csrf_token_hash</span>(<span class="ruby-identifier">action</span>)&#x000A;    <span class="ruby-identifier">hidden_tags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csrf</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">tag</span>.<span class="ruby-identifier">attr</span>[<span class="ruby-value">:method</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">attr</span>[<span class="ruby-string">&#39;method&#39;</span>]).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;POST&#39;</span>}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">opts</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-h'>
<a name='method-i-h'></a>
<div class='synopsis'>
<span class='name'>h</span>
<span class='arguments'>(s)</span>

</div>
<div class='description'>

<p>Convert input to a string adn HTML escape it.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-h-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-h-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 98</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">h</span>(<span class="ruby-identifier">s</span>)&#x000A;  <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">escape_html</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle'>
<a name='method-i-handle'></a>
<div class='synopsis'>
<span class='name'>handle</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the current action, returning an HTML string containing the page
content, or redirecting.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 148</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle</span>&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">before_action_hook</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;handle_#{type}&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_association_links'>
<a name='method-i-handle_association_links'></a>
<div class='synopsis'>
<span class='name'>handle_association_links</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle <a
href="Action.html#method-i-association_links">#association_links</a> action
by returning an HTML fragment of association links.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_association_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_association_links-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 534</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_association_links</span>&#x000A;  <span class="ruby-ivar">@type</span> = <span class="ruby-ivar">@normalized_type</span> = <span class="ruby-ivar">@subtype</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-ivar">@type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">association_links</span>(<span class="ruby-identifier">obj</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_autocomplete'>
<a name='method-i-handle_autocomplete'></a>
<div class='synopsis'>
<span class='name'>handle_autocomplete</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle autocomplete action by returning a string with one line per model
object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_autocomplete-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_autocomplete-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 541</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_autocomplete</span>&#x000A;  <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">query</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;q&#39;</span>].<span class="ruby-identifier">to_s</span>).<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">autocomplete</span>(<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-ivar">@subtype</span>, <span class="ruby-value">:request</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">request</span>, <span class="ruby-value">:association</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">params_association</span>, <span class="ruby-value">:query</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">query</span>, <span class="ruby-value">:exclude</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;exclude&#39;</span>]).<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_browse'>
<a name='method-i-handle_browse'></a>
<div class='synopsis'>
<span class='name'>handle_browse</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle browse action by showing a table containing model objects.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_browse-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_browse-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 438</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_browse</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;csv&#39;</span>&#x000A;    <span class="ruby-identifier">csv</span>(<span class="ruby-value">:browse</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">table_page</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">browse</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_create'>
<a name='method-i-handle_create'></a>
<div class='synopsis'>
<span class='name'>handle_create</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the create action by creating a new model object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_create-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_create-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 267</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_create</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">set_fields</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-value">:new</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">model_params</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:before_create</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">save</span>(<span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:after_create</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_notice</span>(<span class="ruby-node">&quot;Created #{model.class_name}&quot;</span>)&#x000A;    <span class="ruby-identifier">redirect</span>(<span class="ruby-value">:new</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_now_error</span>(<span class="ruby-node">&quot;Error Creating #{model.class_name}&quot;</span>)&#x000A;    <span class="ruby-identifier">new_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_delete'>
<a name='method-i-handle_delete'></a>
<div class='synopsis'>
<span class='name'>handle_delete</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the edit action by showing a list page if there is no model object
selected, or a confirmation screen if there is one.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_delete-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_delete-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 392</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_delete</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">handle_show</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">list_page</span>(<span class="ruby-value">:delete</span>, <span class="ruby-value">:form</span><span class="ruby-operator">=&gt;</span>{<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-string">&#39;delete&#39;</span>)})&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_destroy'>
<a name='method-i-handle_destroy'></a>
<div class='synopsis'>
<span class='name'>handle_destroy</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the destroy action by destroying the model object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_destroy-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_destroy-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 401</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_destroy</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:before_destroy</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:after_destroy</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_notice</span>(<span class="ruby-node">&quot;Deleted #{model.class_name}&quot;</span>)&#x000A;  <span class="ruby-identifier">redirect</span>(<span class="ruby-value">:delete</span>, <span class="ruby-identifier">obj</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_edit'>
<a name='method-i-handle_edit'></a>
<div class='synopsis'>
<span class='name'>handle_edit</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the edit action by showing a list page if there is no model object
selected, or the edit page if there is one.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_edit-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_edit-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 366</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_edit</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:before_edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-identifier">edit_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">list_page</span>(<span class="ruby-value">:edit</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_mtm_edit'>
<a name='method-i-handle_mtm_edit'></a>
<div class='synopsis'>
<span class='name'>handle_mtm_edit</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the mtm_edit action by showing a list page if there is no model
object selected, a list of associations for that model if there is a model
object but no association selected, or a mtm_edit form if there is a model
object and association selected.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_mtm_edit-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_mtm_edit-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 471</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_mtm_edit</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">params_association</span>&#x000A;      <span class="ruby-identifier">options</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">mtm_association_select_options</span>(<span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;        <span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">first</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">assoc</span>&#x000A;      <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;        <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;h2&gt;Edit #{humanize(assoc)} for #{h model.object_display_name(type, request, obj)}&lt;/h2&gt;&quot;</span>&#x000A;        <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;mtm_update/#{model.primary_key_value(obj)}?association=#{assoc}&quot;</span>))&#x000A;        <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_options_for</span>(<span class="ruby-value">:mtm_edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>)&#x000A;          <span class="ruby-identifier">add_opts</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:add</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:add</span>)) <span class="ruby-operator">:</span> <span class="ruby-identifier">opts</span>&#x000A;          <span class="ruby-identifier">remove_opts</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:remove</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:remove</span>)) <span class="ruby-operator">:</span> <span class="ruby-identifier">opts</span>&#x000A;          <span class="ruby-identifier">add_opts</span> = {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;add[]&#39;</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;add&#39;</span>, <span class="ruby-value">:label</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Associate With&#39;</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>)&#x000A;          <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">association_autocomplete?</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">request</span>)&#x000A;            <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">assoc</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;text&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;autoforme_autocomplete&#39;</span>, <span class="ruby-value">:attr</span><span class="ruby-operator">=&gt;</span>{<span class="ruby-string">&#39;data-type&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;association&#39;</span>, <span class="ruby-string">&#39;data-column&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">assoc</span>, <span class="ruby-string">&#39;data-exclude&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">primary_key_value</span>(<span class="ruby-identifier">obj</span>)}, <span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;&#39;</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>))&#x000A;          <span class="ruby-keyword">else</span>&#x000A;            <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">assoc</span>, {<span class="ruby-value">:dataset</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">unassociated_mtm_objects</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">obj</span>), <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">10</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>))&#x000A;          <span class="ruby-keyword">end</span>&#x000A;          <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">assoc</span>, {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;remove[]&#39;</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;remove&#39;</span>, <span class="ruby-value">:label</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Disassociate From&#39;</span>, <span class="ruby-value">:dataset</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_mtm_objects</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">obj</span>), <span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span>[], <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">10</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">remove_opts</span>))&#x000A;          <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Update&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;        <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;        <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-node">&quot;mtm_edit/#{model.primary_key_value(obj)}&quot;</span>), <span class="ruby-identifier">form_opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-value">:select</span>, <span class="ruby-value">:options</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">options</span>, <span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;association&#39;</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;association&#39;</span>, <span class="ruby-value">:label</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Association&#39;</span>, <span class="ruby-value">:add_blank</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>)&#x000A;          <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Edit&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">list_page</span>(<span class="ruby-value">:edit</span>, <span class="ruby-value">:form</span><span class="ruby-operator">=&gt;</span>{})&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_mtm_update'>
<a name='method-i-handle_mtm_update'></a>
<div class='synopsis'>
<span class='name'>handle_mtm_update</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle mtm_update action by updating the related many to many association. 
For ajax requests, return an HTML fragment to update the page, otherwise
redirect to the appropriate form.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_mtm_update-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_mtm_update-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 514</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_mtm_update</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">params_association</span>&#x000A;  <span class="ruby-identifier">assoc_obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">mtm_update</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;add&#39;</span>], <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;remove&#39;</span>])&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_notice</span>(<span class="ruby-node">&quot;Updated #{assoc} association for #{model.class_name}&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;add&#39;</span>]&#x000A;      <span class="ruby-ivar">@type</span> = <span class="ruby-value">:edit</span>&#x000A;      <span class="ruby-identifier">mtm_edit_remove</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_model_class</span>(<span class="ruby-identifier">assoc</span>), <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-node">&quot;&lt;option value=\&quot;#{model.primary_key_value(assoc_obj)}\&quot;&gt;#{model.associated_object_display_name(assoc, request, assoc_obj)}&lt;/option&gt;&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;redir&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;edit&#39;</span>&#x000A;    <span class="ruby-identifier">redirect</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">redirect</span>(<span class="ruby-value">:mtm_edit</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_new'>
<a name='method-i-handle_new'></a>
<div class='synopsis'>
<span class='name'>handle_new</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the new action by always showing the new form.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_new-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_new-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 260</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_new</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-identifier">model</span>.<span class="ruby-identifier">link</span>], <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:before_new</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">new_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_search'>
<a name='method-i-handle_search'></a>
<div class='synopsis'>
<span class='name'>handle_search</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle browse action by showing a search form if no page is selected, or
the correct page of search results if there is a page selected.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_search-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_search-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 448</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_search</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;csv&#39;</span>&#x000A;    <span class="ruby-identifier">csv</span>(<span class="ruby-value">:search_results</span>)&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">table_page</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">search_results</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">model</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">request</span>), <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-string">&quot;search/1&quot;</span>), <span class="ruby-value">:method</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:get</span>), <span class="ruby-identifier">form_opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">model</span>.<span class="ruby-identifier">columns_for</span>(<span class="ruby-value">:search_form</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">column_options_for</span>(<span class="ruby-value">:search_form</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">f</span>.<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>).<span class="ruby-identifier">merge</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">column</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">column</span>)&#x000A;          <span class="ruby-keyword">if</span> <span class="ruby-identifier">html</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">edit_html_for</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>, <span class="ruby-value">:search_form</span>, <span class="ruby-identifier">request</span>)&#x000A;            <span class="ruby-identifier">col_opts</span>[<span class="ruby-value">:html</span>] = <span class="ruby-identifier">html</span>&#x000A;          <span class="ruby-keyword">end</span>&#x000A;          <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">col_opts</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Search&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_show'>
<a name='method-i-handle_show'></a>
<div class='synopsis'>
<span class='name'>handle_show</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the show action by showing a list page if there is no model object
selected, or the show page if there is one.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_show-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_show-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 333</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_show</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">show_page</span>(<span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">list_page</span>(<span class="ruby-value">:show</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_update'>
<a name='method-i-handle_update'></a>
<div class='synopsis'>
<span class='name'>handle_update</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Handle the update action by updating the current model object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_update-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_update-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 377</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_update</span>&#x000A;  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">with_pk</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">set_fields</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">model_params</span>)&#x000A;  <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:before_update</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">save</span>(<span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">hook</span>(<span class="ruby-value">:after_update</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_notice</span>(<span class="ruby-node">&quot;Updated #{model.class_name}&quot;</span>)&#x000A;    <span class="ruby-identifier">redirect</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">request</span>.<span class="ruby-identifier">set_flash_now_error</span>(<span class="ruby-node">&quot;Error Updating #{model.class_name}&quot;</span>)&#x000A;    <span class="ruby-identifier">edit_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-humanize'>
<a name='method-i-humanize'></a>
<div class='synopsis'>
<span class='name'>humanize</span>
<span class='arguments'>(string)</span>

</div>
<div class='description'>

<p>Convert the given object into a suitable human readable string.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-humanize-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-humanize-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 154</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">humanize</span>(<span class="ruby-identifier">string</span>)&#x000A;  <span class="ruby-identifier">string</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-identifier">string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:humanize</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">humanize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/_/</span>, <span class="ruby-string">&quot; &quot;</span>).<span class="ruby-identifier">capitalize</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-inline_mtm_edit_forms'>
<a name='method-i-inline_mtm_edit_forms'></a>
<div class='synopsis'>
<span class='name'>inline_mtm_edit_forms</span>
<span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>HTML fragment used for the inline mtm_edit forms on the edit page.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-inline_mtm_edit_forms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-inline_mtm_edit_forms-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 639</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inline_mtm_edit_forms</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">assocs</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">inline_mtm_assocs</span>(<span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">assocs</span>.<span class="ruby-identifier">empty?</span>&#x000A;&#x000A;  <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;div class=&#39;inline_mtm_add_associations&#39;&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">assocs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;mtm_update/#{model.primary_key_value(obj)}?association=#{assoc}&amp;redir=edit&quot;</span>), <span class="ruby-value">:class</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;mtm_add_associations&#39;</span>, <span class="ruby-string">&#39;data-remove&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-node">&quot;##{assoc}_remove_list&quot;</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">column_options_for</span>(<span class="ruby-value">:mtm_edit</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>)&#x000A;      <span class="ruby-identifier">add_opts</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:add</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:add</span>)) <span class="ruby-operator">:</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">dup</span>&#x000A;      <span class="ruby-identifier">add_opts</span> = {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;add[]&#39;</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-node">&quot;add_#{assoc}&quot;</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">association_autocomplete?</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">request</span>)&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">assoc</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;text&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;autoforme_autocomplete&#39;</span>, <span class="ruby-value">:attr</span><span class="ruby-operator">=&gt;</span>{<span class="ruby-string">&#39;data-type&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;association&#39;</span>, <span class="ruby-string">&#39;data-column&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">assoc</span>, <span class="ruby-string">&#39;data-exclude&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">primary_key_value</span>(<span class="ruby-identifier">obj</span>)}, <span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;&#39;</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>))&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">assoc</span>, {<span class="ruby-value">:dataset</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">unassociated_mtm_objects</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">obj</span>), <span class="ruby-value">:multiple</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">false</span>, <span class="ruby-value">:add_blank</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">add_opts</span>))&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Add&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-xs btn-primary&#39;</span>)&#x000A;    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/div&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;div class=&#39;inline_mtm_remove_associations&#39;&gt;&lt;ul&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">assocs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">mc</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_model_class</span>(<span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;li&gt;&quot;</span>&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_class_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;ul id=&#39;#{assoc}_remove_list&#39;&gt;&quot;</span>&#x000A;    <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">assoc</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc_obj</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mtm_edit_remove</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">mc</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/ul&gt;&lt;/li&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/ul&gt;&lt;/div&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-list_page'>
<a name='method-i-list_page'></a>
<div class='synopsis'>
<span class='name'>list_page</span>
<span class='arguments'>(type, opts={})</span>

</div>
<div class='description'>

<p>Shared page used by show, edit, and delete actions that shows a list of
available model objects (or an autocompleting box), and allows the user to
choose one to act on.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-list_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-list_page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 283</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">list_page</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:form</span>] <span class="ruby-operator">||</span> {<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-identifier">type</span>)})&#x000A;    <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">input_opts</span> = {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;id&#39;</span>, <span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;id&#39;</span>, <span class="ruby-value">:label</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">class_name</span>}&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">autocomplete_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;        <span class="ruby-identifier">input_type</span> = <span class="ruby-value">:text</span>&#x000A;        <span class="ruby-identifier">input_opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;autoforme_autocomplete&#39;</span>, <span class="ruby-value">:attr</span><span class="ruby-operator">=&gt;</span>{<span class="ruby-string">&#39;data-type&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">type</span>})&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-identifier">input_type</span> = <span class="ruby-value">:select</span>&#x000A;        <span class="ruby-identifier">input_opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:options</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">select_options</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>), <span class="ruby-value">:add_blank</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">input_type</span>, <span class="ruby-identifier">input_opts</span>)&#x000A;      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">capitalize</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-node">&quot;btn btn-#{type == :delete ? &#39;danger&#39; : &#39;primary&#39;}&quot;</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-model_params'>
<a name='method-i-model_params'></a>
<div class='synopsis'>
<span class='name'>model_params</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Get request parameters for the model.  Used when retrieving form values
that use namespacing.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-model_params-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-model_params-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 104</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">model_params</span>&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-identifier">model</span>.<span class="ruby-identifier">params_name</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-mtm_edit_remove'>
<a name='method-i-mtm_edit_remove'></a>
<div class='synopsis'>
<span class='name'>mtm_edit_remove</span>
<span class='arguments'>(assoc, mc, obj, assoc_obj)</span>

</div>
<div class='description'>

<p>Line item containing form to remove the currently associated object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-mtm_edit_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-mtm_edit_remove-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 675</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">mtm_edit_remove</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">mc</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;  <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;li&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_link</span>(<span class="ruby-identifier">mc</span>, <span class="ruby-identifier">assoc_obj</span>)&#x000A;  <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;mtm_update/#{model.primary_key_value(obj)}?association=#{assoc}&amp;remove%5b%5d=#{model.primary_key_value(assoc_obj)}&amp;redir=edit&quot;</span>), <span class="ruby-value">:method</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;post&#39;</span>, <span class="ruby-value">:class</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;mtm_remove_associations&#39;</span>, <span class="ruby-string">&#39;data-add&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-node">&quot;#add_#{assoc}&quot;</span>)&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Remove&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-xs btn-danger&#39;</span>)&#x000A;  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/li&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_page'>
<a name='method-i-new_page'></a>
<div class='synopsis'>
<span class='name'>new_page</span>
<span class='arguments'>(obj, opts={})</span>

</div>
<div class='description'>

<p>HTML content used for the new action</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 243</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_page</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-string">&quot;create&quot;</span>))&#x000A;    <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">model</span>.<span class="ruby-identifier">columns_for</span>(<span class="ruby-value">:new</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">column_options_for</span>(<span class="ruby-value">:new</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)&#x000A;        <span class="ruby-keyword">if</span> <span class="ruby-identifier">html</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">edit_html_for</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>, <span class="ruby-value">:new</span>, <span class="ruby-identifier">request</span>)&#x000A;          <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">col_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:html</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">html</span>)&#x000A;        <span class="ruby-keyword">end</span>&#x000A;        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">col_opts</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Create&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-page'>
<a name='method-i-page'></a>
<div class='synopsis'>
<span class='name'>page</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Yields and wraps the returned data in a header and footer for the page.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 216</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">page</span>&#x000A;  <span class="ruby-identifier">html</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">model</span>.<span class="ruby-identifier">page_header_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tabs</span>)&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;div id=&#39;autoforme_content&#39; data-url=&#39;#{url_for(&#39;&#39;)}&#39;&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">yield</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/div&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">page_footer_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-identifier">html</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-redirect'>
<a name='method-i-redirect'></a>
<div class='synopsis'>
<span class='name'>redirect</span>
<span class='arguments'>(type, obj)</span>

</div>
<div class='description'>

<p>Redirect to a page based on the type of action and the given object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-redirect-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 125</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">redirect</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">redir</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">redirect_for</span>&#x000A;    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">redir</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">path</span>&#x000A;    <span class="ruby-identifier">path</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:new</span>, <span class="ruby-value">:delete</span>&#x000A;      <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:edit</span>&#x000A;      <span class="ruby-node">&quot;edit/#{model.primary_key_value(obj)}&quot;</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:mtm_edit</span>&#x000A;      <span class="ruby-node">&quot;mtm_edit/#{model.primary_key_value(obj)}?association=#{params_association}&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">url_for</span>(<span class="ruby-identifier">path</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">path</span>)&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-show_page'>
<a name='method-i-show_page'></a>
<div class='synopsis'>
<span class='name'>show_page</span>
<span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>The page to use when displaying an object, always used as a confirmation
screen when deleting an object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-show_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-show_page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 302</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">show_page</span>(<span class="ruby-identifier">obj</span>)&#x000A;  <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">t</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;    <span class="ruby-identifier">f</span> = <span class="ruby-constant">Forme</span><span class="ruby-operator">::</span><span class="ruby-constant">Form</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-value">:formatter</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:readonly</span>, <span class="ruby-value">:wrapper</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:trtd</span>, <span class="ruby-value">:labeler</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:explicit</span>)&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;table class=\&quot;#{model.table_class_for(:show, request)}\&quot;&gt;&quot;</span>&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">columns_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">column_options_for</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">html</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">show_html_for</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">column</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;        <span class="ruby-identifier">col_opts</span> = <span class="ruby-identifier">col_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:html</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">html</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">input</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">col_opts</span>).<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;/table&gt;&#39;</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:show</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-value">:edit</span>, <span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;edit/#{model.primary_key_value(obj)}&quot;</span>)), <span class="ruby-identifier">form_opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f1</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">f1</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Edit&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-primary&#39;</span>)&#x000A;      <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:delete</span>&#x000A;      <span class="ruby-identifier">form_attr</span> = <span class="ruby-identifier">form_attributes</span>(<span class="ruby-value">:action</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">url_for</span>(<span class="ruby-node">&quot;destroy/#{model.primary_key_value(obj)}&quot;</span>), <span class="ruby-value">:method</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:post</span>)&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Forme</span>.<span class="ruby-identifier">form</span>(<span class="ruby-identifier">form_attr</span>, <span class="ruby-identifier">form_opts</span>(<span class="ruby-identifier">form_attr</span>[<span class="ruby-value">:action</span>])) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f1</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">f1</span>.<span class="ruby-identifier">button</span>(<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Delete&#39;</span>, <span class="ruby-value">:class</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;btn btn-danger&#39;</span>)&#x000A;      <span class="ruby-keyword">end</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">association_links</span>(<span class="ruby-identifier">obj</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">t</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-subtype'>
<a name='method-i-subtype'></a>
<div class='synopsis'>
<span class='name'>subtype</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>The subtype of request, used for <a
href="Action.html#method-i-association_links">#association_links</a> and
autocomplete actions.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-subtype-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-subtype-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 120</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">subtype</span>&#x000A;  ((<span class="ruby-identifier">t</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;type&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ALL_SUPPORTED_ACTIONS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">t</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_sym</span>) <span class="ruby-operator">||</span> <span class="ruby-value">:edit</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-supported-3F'>
<a name='method-i-supported-3F'></a>
<div class='synopsis'>
<span class='name'>supported?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Return true if the action is supported, and false otherwise.  An action may
not be supported if the type is not one of the supported types, or if an
non-idemponent request is issued with get instead of post, or potentionally
other reasons.</p>

<p>As a side-effect, this sets up additional state related to the request.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-supported-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-supported-3F-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 54</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">supported?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">ALL_SUPPORTED_ACTIONS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">action_type</span>)&#x000A;  <span class="ruby-identifier">type</span> = <span class="ruby-ivar">@type</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">action_type</span>.<span class="ruby-identifier">to_sym</span>&#x000A;  <span class="ruby-ivar">@normalized_type</span> = <span class="ruby-constant">NORMALIZED_ACTION_MAP</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">NON_IDEMPOTENT_TYPES</span>[<span class="ruby-identifier">type</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>&#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:mtm_edit</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">request</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;association&#39;</span>])&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_mtm_edit?</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-ivar">@params_association</span> = <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">to_sym</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;#{model.class_name} - #{TITLE_MAP[type]}&quot;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:mtm_update</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;association&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_mtm_update?</span>(<span class="ruby-identifier">assoc</span>, <span class="ruby-identifier">request</span>)&#x000A;    <span class="ruby-ivar">@params_association</span> = <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">to_sym</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:association_links</span>&#x000A;    <span class="ruby-ivar">@subtype</span> = <span class="ruby-identifier">subtype</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-ivar">@subtype</span>, <span class="ruby-identifier">request</span>)&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:autocomplete</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">assoc</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">association?</span>(<span class="ruby-identifier">assoc</span>)&#x000A;      <span class="ruby-ivar">@params_association</span> = <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">to_sym</span>&#x000A;      <span class="ruby-ivar">@subtype</span> = <span class="ruby-value">:association</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">associated_class</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">associated_model_class</span>(<span class="ruby-ivar">@params_association</span>)&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">associated_class</span>.<span class="ruby-identifier">autocomplete_options_for</span>(<span class="ruby-ivar">@subtype</span>, <span class="ruby-identifier">request</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-ivar">@subtype</span> = <span class="ruby-identifier">subtype</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">autocomplete_options_for</span>(<span class="ruby-ivar">@subtype</span>, <span class="ruby-identifier">request</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">request</span>)&#x000A;&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">title</span> = <span class="ruby-constant">TITLE_MAP</span>[<span class="ruby-ivar">@normalized_type</span>]&#x000A;      <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;#{model.class_name} - #{title}&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-tab_name'>
<a name='method-i-tab_name'></a>
<div class='synopsis'>
<span class='name'>tab_name</span>
<span class='arguments'>(type)</span>

</div>
<div class='description'>

<p>The name to give the tab for the given type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-tab_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-tab_name-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 204</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">tab_name</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:browse</span>&#x000A;    <span class="ruby-identifier">model</span>.<span class="ruby-identifier">class_name</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:mtm_edit</span>&#x000A;    <span class="ruby-string">&#39;MTM&#39;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">capitalize</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-table_page'>
<a name='method-i-table_page'></a>
<div class='synopsis'>
<span class='name'>table_page</span>
<span class='arguments'>(next_page, objs)</span>

</div>
<div class='description'>

<p>Show page used for browse/search pages.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-table_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-table_page-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 431</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_page</span>(<span class="ruby-identifier">next_page</span>, <span class="ruby-identifier">objs</span>)&#x000A;  <span class="ruby-identifier">page</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-constant">Table</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">objs</span>).<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">table_pager</span>(<span class="ruby-identifier">normalized_type</span>, <span class="ruby-identifier">next_page</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-table_pager'>
<a name='method-i-table_pager'></a>
<div class='synopsis'>
<span class='name'>table_pager</span>
<span class='arguments'>(type, next_page)</span>

</div>
<div class='description'>

<p>HTML fragment for the table pager, showing links to next page or previous
page for browse/search forms.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-table_pager-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-table_pager-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 411</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_pager</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">next_page</span>)&#x000A;  <span class="ruby-identifier">html</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;ul class=&quot;pager&quot;&gt;&#39;</span>&#x000A;  <span class="ruby-identifier">page</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_i</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;li&gt;&lt;a href=\&quot;#{url_for(&quot;#{type}/#{page-1}?#{h request.query_string}&quot;)}\&quot;&gt;Previous&lt;/a&gt;&lt;/li&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;Previous&lt;/a&gt;&lt;/li&gt;&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">next_page</span>&#x000A;    <span class="ruby-identifier">page</span> = <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;li&gt;&lt;a href=\&quot;#{url_for(&quot;#{type}/#{page+1}?#{h request.query_string}&quot;)}\&quot;&gt;Next&lt;/a&gt;&lt;/li&gt;&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;Next&lt;/a&gt;&lt;/li&gt;&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&lt;/ul&gt;&quot;</span>&#x000A;  <span class="ruby-identifier">html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;p&gt;&lt;a href=\&quot;#{url_for(&quot;#{type}/csv?#{h request.query_string}&quot;)}\&quot;&gt;CSV Format&lt;/a&gt;&lt;/p&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-tabs'>
<a name='method-i-tabs'></a>
<div class='synopsis'>
<span class='name'>tabs</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>HTML fragment for the default page header, which uses tabs for each
supported action.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-tabs-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-tabs-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 192</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">tabs</span>&#x000A;  <span class="ruby-identifier">content</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">content</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;ul class=&quot;nav nav-tabs&quot;&gt;&#39;</span>&#x000A;  <span class="ruby-constant">Model</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_SUPPORTED_ACTIONS</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">action_type</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">supported_action?</span>(<span class="ruby-identifier">action_type</span>, <span class="ruby-identifier">request</span>)&#x000A;      <span class="ruby-identifier">content</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;li class=\&quot;#{&#39;active&#39; if type == action_type}\&quot;&gt;&lt;a href=\&quot;#{url_for(action_type)}\&quot;&gt;#{tab_name(action_type)}&lt;/a&gt;&lt;/li&gt;&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">content</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;/ul&gt;&#39;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-url_for'>
<a name='method-i-url_for'></a>
<div class='synopsis'>
<span class='name'>url_for</span>
<span class='arguments'>(page)</span>

</div>
<div class='description'>

<p>A path for the given page for the same model.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-url_for-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-url_for-source'><span class="ruby-comment"># File lib/autoforme/action.rb, line 115</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">url_for</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-identifier">base_url_for</span>(<span class="ruby-node">&quot;#{model.link}/#{page}&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
