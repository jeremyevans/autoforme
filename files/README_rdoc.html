<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>README.rdoc</title>
    <meta content='text/html; charset=US-ASCII' http-equiv='Content-Type'>
    <link href='../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='file' id='wrapper'>
      <div class='header'>
        <h1 class='name'>README.rdoc</h1>
        <div class='paths'>
          README.rdoc
        </div>
        <div class='last-update'>
          Last Update:
          <span class='datetime'>2013-12-13 13:02:56 -0800</span>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <h1 id="label-AutoForme"><a href="../classes/AutoForme.html">AutoForme</a></h1>
            
            <p><a href="../classes/AutoForme.html">AutoForme</a> is an administrative web
            front end to an ORM that uses Forme [1] for building the HTML forms.  It is
            designed to integrate easily into web frameworks, and currently supports
            both Sinatra and Rails.</p>
            
            <p>AutoForme&#39;s UI and capabilities are modeled on scaffolding_extensions
            [2], though <a href="../classes/AutoForme.html">AutoForme</a> is
            considerably more flexible in terms of configuration.</p>
            <ol><li>
            <p><a
            href="https://github.com/jeremyevans/forme">github.com/jeremyevans/forme</a></p>
            </li><li>
            <p><a
            href="https://github.com/jeremyevans/scaffolding_extensions">github.com/jeremyevans/scaffolding_extensions</a></p>
            </li></ol>
            
            <h1 id="label-Installation">Installation</h1>
            
            <pre>sudo gem install autoforme</pre>
            
            <h1 id="label-Demo+Site">Demo Site</h1>
            
            <p>A demo site is available at <a
            href="http://autoforme-demo.jeremyevans.net">autoforme-demo.jeremyevans.net</a></p>
            
            <h1 id="label-Documentation+Site">Documentation Site</h1>
            
            <p>RDoc Documentation is available at <a
            href="http://autoforme.jeremyevans.net">autoforme.jeremyevans.net</a></p>
            
            <h1 id="label-Source+Code">Source Code</h1>
            
            <p>Source code is available on GitHub at <a
            href="https://github.com/jeremyevans/autoforme">github.com/jeremyevans/autoforme</a></p>
            
            <h1 id="label-Features">Features</h1>
            <ul><li>
            <p>Create, update, edit, and view model objects</p>
            </li><li>
            <p>Browse and search model objects</p>
            </li><li>
            <p>Edit many-to-many relationships for model objects</p>
            </li><li>
            <p>Easily access associated objects</p>
            </li><li>
            <p>Support autocompletion for all objects</p>
            </li><li>
            <p>Allow customization for all likely configuration points, using any
            parameters available in the request</p>
            </li></ul>
            
            <h1 id="label-Basic+Configuration">Basic Configuration</h1>
            
            <p><a href="../classes/AutoForme.html">AutoForme</a> is configured using a
            fairly simple DSL.  Here is an example:</p>
            
            <pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">App</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sinatra</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>&#x000A;  <span class="ruby-constant">AutoForme</span>.<span class="ruby-identifier">for</span>(:<span class="ruby-identifier">sinatra</span>, <span class="ruby-keyword">self</span>) <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">model_type</span> :<span class="ruby-identifier">sequel</span>&#x000A;    <span class="ruby-identifier">order</span> [:<span class="ruby-identifier">name</span>]&#x000A;&#x000A;    <span class="ruby-identifier">model</span> <span class="ruby-constant">Artist</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">columns</span> [:<span class="ruby-identifier">name</span>]&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">model</span> <span class="ruby-constant">Album</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">columns</span> [:<span class="ruby-identifier">artist</span>, :<span class="ruby-identifier">name</span>]&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
            
            <p>Let&#39;s break down how this works.  You setup <a
            href="../classes/AutoForme.html">AutoForme</a> using
            <code>AutoForme.for</code>, which takes 2 arguments, the controller type
            symbol (currently either :sinatra or :rails), and the controller class
            (either a Sinatra::Base or ActionController::Base subclass).  You pass
            <code>AutoForme.for</code> a block, which is instance evaled at the
            framework level.  This level sets the defaults.</p>
            
            <p>Inside the framework block, you first call model_type with a symbol
            representing the ORM you are using.  Currently, only Sequel is supported,
            so this should be :sequel.</p>
            
            <p>The order call in the framework block sets the default order for all
            models.</p>
            
            <p>The model calls in the framework block take a ORM model class.  As only
            Sequel is currently supported, this should be a Sequel::Model subclass. 
            The block passed to the model method is instance evaled at the model level,
            and sets the configuration for that model.  In this example, the Artist
            model will only show the name column, and the Album model will only show
            the artist association and the name column.</p>
            
            <p>In your application, you can then to go &#39;/Artist/browse&#39; or
            &#39;/Album/browse&#39; to get to the web UI exposed to <a
            href="../classes/AutoForme.html">AutoForme</a>.</p>
            
            <h1 id="label-Design">Design</h1>
            
            <h2 id="label-Principles">Principles</h2>
            <ul><li>
            <p>Use Forme to generate the forms</p>
            </li><li>
            <p>Do not modify/extend model or controller classes</p>
            </li><li>
            <p>Assume that the web framework provides the layout</p>
            </li><li>
            <p>Do not use templates, render form objects to strings</p>
            </li><li>
            <p>Use a block-based DSL in the controller for configuration</p>
            </li><li>
            <p>Allow customization on a per-request basis for everything</p>
            </li></ul>
            
            <h2 id="label-Basic+Implementation">Basic Implementation</h2>
            
            <p>The web framework controllers call <code>AutoForme.for</code> to create <a
            href="../classes/AutoForme/Framework.html">AutoForme::Framework</a>
            instances, which contain and set default values for <a
            href="../classes/AutoForme/Model.html">AutoForme::Model</a> instances.</p>
            
            <p>When a request comes in from the web framework, the <a
            href="../classes/AutoForme/Framework.html">AutoForme::Framework</a>
            instance wraps request-level data in a <a
            href="../classes/AutoForme/Request.html">AutoForme::Request</a>.  Then it
            creates an <a href="../classes/AutoForme/Action.html">AutoForme::Action</a>
            to handle this request.  The <a
            href="../classes/AutoForme/Action.html">AutoForme::Action</a> either
            returns a string that the web framework then renders, or it redirects to
            another page.</p>
            
            <h1 id="label-Advanced+Configuration">Advanced Configuration</h1>
            
            <p><a href="../classes/AutoForme.html">AutoForme</a> doesn&#39;t have all that
            many features compared to other admin frameworks, but the features it does
            have are extremely flexible.</p>
            
            <p>Most of the configuration you&#39;ll do in <a
            href="../classes/AutoForme.html">AutoForme</a> is at the model level (in
            the context of an <a
            href="../classes/AutoForme/Model.html">AutoForme::Model</a> instance), so
            we&#39;ll start looking at the customization options there.  The most
            common options are probably:</p>
            <dl class="rdoc-list note-list"><dt>columns 
            <dd>
            <p>This is an array of column/association name symbols to use for the model.</p>
            </dd><dt>column_options 
            <dd>
            <p>This is a hash of column options for the model, keyed by column symbol,
            with values that are hashes of column options.</p>
            </dd><dt>order 
            <dd>
            <p>This is an expression or an array of expressions by which to order returned
            rows.</p>
            </dd></dl>
            
            <p>Note that for each of the customization options, you can do per-request
            customization by using a proc which is called with the type symbol and
            request (<a href="../classes/AutoForme/Request.html">AutoForme::Request</a>
            instance), which should return an appropriate object.</p>
            <dl class="rdoc-list note-list"><dt>columns 
            <dd>
            <p>Proc called with type symbol and request, should return array of
            column/association symbols</p>
            </dd><dt>column_options 
            <dd>
            <p>Proc called with column/association symbol, type symbol and request, should
            return hash of column options.</p>
            </dd><dt>order 
            <dd>
            <p>Proc called with type symbol and request, should return expression  or
            array of expressions by which to order returned rows.</p>
            </dd></dl>
            
            <p>Below is brief description of other available options.  Note that just like
            the above options you can use Procs with most of these options to do
            customization on a per-request basis.</p>
            <dl class="rdoc-list note-list"><dt>association_links 
            <dd>
            <p>Array of association symbols for associations to display on the show/edit
            pages, can also be set to :all for all associations or :all_except_mtm for
            all associations except many to many associations.</p>
            </dd><dt>autocomplete_options 
            <dd>
            <p>Enable autocompletion for this model, with the given options.  The
            following keys are respected:</p>
            <dl class="rdoc-list note-list"><dt>:callback 
            <dd>
            <p>Proc called with dataset and options hash containing :type, :request, and
            :query</p>
            </dd><dt>:display 
            <dd>
            <p>A SQL expression to search on and display in the result</p>
            </dd><dt>:limit 
            <dd>
            <p>The number of results to return</p>
            </dd><dt>:filter 
            <dd>
            <p>Similar to callback, but overriding the default filter (a case insensitive
            substring search on display)</p>
            </dd></dl>
            </dd><dt>eager 
            <dd>
            <p>Array of associations to eagerly load in separate queries</p>
            </dd><dt>eager_graph 
            <dd>
            <p>Array of associations to eager load in the same query (necessary if order
            or filter refers to them)</p>
            </dd><dt>filter 
            <dd>
            <p>A Proc called with a dataset, type symbol, and request that can be used to
            filter the available rows.  Can be used to implement access control.</p>
            </dd><dt>redirect 
            <dd>
            <p>A Proc called with an object, type symbol, and request that can be used to
            override the default redirecting after form submittal.</p>
            </dd><dt>inline_mtm_associations 
            <dd>
            <p>Array of many to many association symbols to allow editing on the edit page</p>
            </dd><dt>lazy_load_association_links 
            <dd>
            <p>Whether to show the association links directly on the show/edit pages, or
            to load them via ajax on request</p>
            </dd><dt>mtm_associations 
            <dd>
            <p>Array of many to many association symbols to support editing on a separate
            page</p>
            </dd><dt>per_page 
            <dd>
            <p>Number of records to show per page on the browse and search pages</p>
            </dd><dt>session_value 
            <dd>
            <p>Sets up a filter and before_create hook that makes it so access is limited
            to objects where the object&#39;s column value is the same as the session
            value with the same name.</p>
            </dd><dt>supported_actions 
            <dd>
            <p>Array of action symbols to support for the model, should be a subset of</p>
            <dl class="rdoc-list label-list"><dt>:browse, :new, :show, :edit, :delete, :search, :mtm_edit
            <dd></dd></dl>
            </dd></dl>
            
            <p>These options are related to displayed output:</p>
            <dl class="rdoc-list note-list"><dt>form_attributes 
            <dd>
            <p>Hash of attributes to use for any form tags</p>
            </dd><dt>form_options 
            <dd>
            <p>Hash of Forme::Form options to pass for any forms created</p>
            </dd><dt>class_display_name 
            <dd>
            <p>The string to use when referring to the model class</p>
            </dd><dt>display_name 
            <dd>
            <p>The string to use when referring to a model instance.  Can either be a
            symbol representing an instance method call, or a Proc called with the
            model object, the model object and type symbol, or the model object, type
            symbol, and request, depending on the arity of the Proc.</p>
            </dd><dt>link_name 
            <dd>
            <p>The string to use in links for the class</p>
            </dd><dt>page_footer 
            <dd>
            <p>Override the default footer used for pages</p>
            </dd><dt>page_header 
            <dd>
            <p>Override the default header used for pages</p>
            </dd><dt>table_class 
            <dd>
            <p>The html class string to use for the browse and search tables</p>
            </dd></dl>
            
            <p>These hook options should be callable objects that are called with the
            model object and the request.</p>
            <dl class="rdoc-list note-list"><dt>after_create 
            <dd>
            <p>Called after creating the object</p>
            </dd><dt>after_destroy 
            <dd>
            <p>Called after destroy the object</p>
            </dd><dt>after_update 
            <dd>
            <p>Called after updating the object</p>
            </dd><dt>before_create 
            <dd>
            <p>Called before creating the object</p>
            </dd><dt>before_destroy 
            <dd>
            <p>Called before destroy the object</p>
            </dd><dt>before_edit 
            <dd>
            <p>Called before displaying object on edit page</p>
            </dd><dt>before_new 
            <dd>
            <p>Called before displaying object on new page</p>
            </dd><dt>before_update 
            <dd>
            <p>Called before updating the object</p>
            </dd></dl>
            
            <p>There&#39;s also an addition before_action hook that is called with the
            type symbol of the request, and the request before every page.</p>
            
            <p>In addition to being specified at the model level, almost all of these
            options can be specified at the framework level, where they operate as
            default values for models that don&#39;t specify the options. Just like the
            model level, the framework level also allows customization on a per request
            basis, though framework-level Procs generally take the model class as an
            initial argument (in addition to the type symbol and request).</p>
            
            <p>Additionally, <a
            href="../classes/AutoForme.html#method-c-for">AutoForme.for</a> accepts a
            :prefix option that controls where the forms are mounted:</p>
            
            <pre class="ruby"><span class="ruby-constant">AutoForm</span>.<span class="ruby-identifier">for</span>(:<span class="ruby-identifier">sinatra</span>, <span class="ruby-keyword">self</span>, :<span class="ruby-identifier">prefix=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&#39;/path/to&#39;</span>) <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">model</span> <span class="ruby-constant">Artist</span>&#x000A;<span class="ruby-keyword">end</span></pre>
            
            <p>Means you can go to <code>/path/to/Artist/browse</code> to browse the
            artists.</p>
            
            <h1 id="label-Javascript">Javascript</h1>
            
            <p>By default, <a href="../classes/AutoForme.html">AutoForme</a> requires no
            javascript.  The only optional part of <a
            href="../classes/AutoForme.html">AutoForme</a> that requires javascript is
            the autocompleting. <a href="../classes/AutoForme.html">AutoForme</a> also
            has javascript support for the progressive enhancement of the following:</p>
            <ul><li>
            <p>Loading association links via ajax if lazy_load_association_links is true.</p>
            </li><li>
            <p>Adding and removing many-to-many associated objects via ajax for
            inline_mtm_associations</p>
            </li></ul>
            
            <p>AutoForme&#39;s javascript support is contained in the autoforme.js file in
            the root of the distribution.  AutoForme&#39;s autocompleting support also
            requires <a
            href="https://github.com/dyve/jquery-autocomplete">github.com/dyve/jquery-autocomplete</a></p>
            
            <h1 id="label-TODO">TODO</h1>
            <ul><li>
            <p>capybara-webkit tests for ajax behavior</p>
            </li><li>
            <p>read_only fields for edit page</p>
            </li><li>
            <p>one_to_many/many_to_many associations in columns</p>
            </li><li>
            <p>configurable searching</p>
            </li><li>
            <p>nested form objects</p>
            </li></ul>
            
            <h1 id="label-License">License</h1>
            
            <p>MIT</p>
            
            <h1 id="label-Author">Author</h1>
            
            <p>Jeremy Evans &lt;code@jeremyevans.net&gt;</p>
          </div>
          <div id='context'>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
